<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0088)http://www.uamt.feec.vutbr.cz/~richter/vyuka/PC2A/cviceni/07_vypusteni_komentaru.html.cs -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
	
	<title></title>
	<meta name="GENERATOR" content="OpenOffice 4.1.3  (Win32)">
	<meta name="AUTHOR" content="Miloslav Richter">
	<meta name="CREATED" content="20051002;20345600">
	<meta name="CHANGEDBY" content="Richter">
	<meta name="CHANGED" content="20170321;11013006">
	<style type="text/css">
	<!--
		@page { size: 21cm 29.7cm; margin-left: 2cm; margin-right: 1cm; margin-top: 1cm; margin-bottom: 1cm }
		P { margin-bottom: 0.21cm; background: transparent; page-break-inside: avoid; page-break-before: auto; page-break-after: auto }
		A:link { color: #000080; so-language: zxx; text-decoration: underline }
		A:visited { color: #800000; so-language: zxx; text-decoration: underline }
	-->
	</style>
</head>
<body lang="cs-CZ" link="#000080" vlink="#800000" dir="LTR">
<p align="CENTER"><font size="6"><b>Vypu¹tìní komentáøù &#8211; stavový
automat <font size="3">(2015)</font></b></font></p>
<p><br><br>
</p>
<p><b>Zadání:</b></p>
<p>Napi¹te program, který vypustí komentáøe ze souboru (zdrojový nebo
hlavièkový jazyka C/C++) a výsledek zapí¹e do jiného souboru. Úlohu
vyøe¹te pomocí principu stavového automatu.</p>
<p><br><br>
</p>
<p><b>Upøesnìní zadání:</b></p>
<ul>
	<li><p>Program vyøe¹te pomocí stavového automatu (pou¾ijte pøíkaz
	switch. K &#8222;pojmenování&#8220; stavù pou¾ijte &#8222;textových&#8220;
	hodnot enum (alternativa k pou¾ití #define)</p>
	</li><li><p>Komentáøe pøedpokládejte v obou tvarech (tj. &#8222;/* */&#8220;
	i &#8222; // &#8220; ).</p>
	</li><li><p>Znaky &#8222;komentáøù&#8220; se nevyskytují (=nemusíte
	øe¹it) v øetìzcích a znakových konstantách. Nemusíte øe¹it trigrafy.
	Neøe¹te výskyt v makrech, ani blocích podmínìného pøekladu.</p>
	</li><li><p>Název vstupního i výstupního souboru je pøedán jako parametr
	(na pøíkazové øádce) pøi spu¹tìní programu.</p>
	</li><li><p>Pøi otevírání souborù otestujte, zda se otevøení zdaøilo</p>
	</li><li><p>Otevøené soubory zavøete</p>
	</li><li><p>Pro stavy pou¾ijte výètový typ enum.</p>
	</li><li><p>Vypu¹tìný komentáø /* */ nahraïte mezerou.</p>
</li></ul>
<p><br><br>
</p>
<p><b>Nápovìda øe¹ení:</b></p>
<p>Princip stavového automatu se pou¾ívá v situacích, kdy je mo¾né
úlohu rozdìlit na èásti/stavy, které splòují urèité vlastnosti. <br>V
pøípadì stavového automatu je nutné nalézt èásti programu tak,
abychom mohli urèit (jednoznaèné) pøechody mezi jednotlivými stavy.
<br>Stav je situace, kdy se program chová (na vstupy) stejnì. <br>Ke
zmìnì/pøechodu stavu dochází pøi urèité události/událostech <span lang="en-US">na
vstupu</span>.<br><span lang="en-US">V</span><span lang="cs-CZ">ýhodou
zápisu pomocí stavového automatu je skuteènost, ¾e jednotlivé stavy
jsou od sebe ve zdrojovém textu zcela izolovány (oproti vícenásobným
vnoøením, pøi realizaci pomocí pøíkazu if) a umo¾òují tak
programátorovi lep¹í kontrolu nad zdrojovým textem a budoucí
roz¹íøitelnost stavového automatu.<br>V¹imnìte si, ¾e realizace
pomocí stavového automatu nepotøebuje promìnné obsahující pøedchozí
hodnoty vstupu (historii vstupu), nebo» samotný stav tuto skuteènost
plnì reprezentuje.</span><br>Pro pøechody mezi stavy je nutné urèit
události/situace, za kterých k pøechodu dochází (napøíklad
hodnota/hodnoty vstupu, èasový signál...) a èinnost, která se pøi
tomto pøechodu provede. <br>Ke stejnému pøechodu mù¾e dojít pøi více
typech vstupu (na urèitou mno¾inu situací/vstupù reaguje stejnì).
<br>Mù¾e docházet i k &#8222;pøechodu&#8220; do stejného stavu (pokud
se nestane nìco výjimeèného zùstáváme ve stejném stavu).</p>
<p>Pro ná¹ pøípad vypou¹tìní komentáøù je dùle¾ité ponechat úseky
mimo komentáøe (TEXT), zjistit zaèátek a konec komentáøe, komentáø
vypustit.<br>Mù¾eme tedy urèit stavy TEXT, KOMENTAR1, KOMENTAR2 a
stavy pøechodù. <br>Jako impulz pro èinnost vezmeme znak ze vstupního
souboru, na jeho¾ základì rozhodneme o pøechodu (&#8222;pøepnutí&#8220;)
do jiného stavu a vykonávané èinnosti. <br>Pøedstavme si, ¾e naèteme
znak <span lang="en-US">'/'. </span><span lang="cs-CZ">Reakce na
tento znak bude v ka¾dém stavu jiná. V TEXTu to mù¾e být &#8222;normální&#8220;
znak (který se vytiskne), nebo zaèátek komentáøe (který se netiskne)
&#8211; pøi pøíchodu tohoto znaku se tedy pøepneme do nového stavu,
kdy dal¹í naètený znak rozhodne, která situace nastala (a zda se
vrátíme do stavu TEXT, nebo se pøepneme do stavu KOMENTARX).
Pøijde-li tento znak v okam¾iku, kdy jsme v komentáøi, potom ho
vypustíme. Je zde tedy vidìt princip stavù &#8211; stejný podnìt se v
rùzných stavech øe¹í rùznì, (nìkdy) má vliv na zmìnu stavu a (nìkdy)
na provádìnou akci.</span><br><br><br>
</p>
<p>Návrh (nìkolika) stavù pro tento pøíklad:</p>
<p>TEXT &#8211; jsme uprostøed textu, který se kopíruje na výstup
(objeví-li se lomítko, je nutno se pøepnout do stavu, kdy lze
oèekávat komentáø &#8211; lomítko se na výstup nezapí¹e)</p>
<p>LOMITKO &#8211; minulý znak bylo lomítko (podle aktuálního znaku
poznáme, zda se jedná o /*, // nebo skuteènì o lomítko</p>
<p>KOMENT1 &#8211; jsme uvnitø komentáøe /*, dal¹í hvìzdièka je
potencionální konec 
</p>
<p>HVEZDICKA &#8211; následuje-li po hvìzdièce (v komentáøi
zaèínajícím /*) lomítko, konèí komentáø, je-li to jiný znak, vracíme
se do KOMENT1</p>
<p>KOMENT2 &#8211; jsme uvnitø øádkového komentáøe &#8211; konèí
koncem øádky (pak je TEXT)</p>
<p>&#8230;</p>
<p><br><br>
</p>
<p>Pro øe¹ení stavového diagramu se s výhodou pou¾ívá pøíkazù
switch/case realizující vìtvení na základì celoèíselné promìnné
reprezentující akuální stav programu. Celoèíselnou promìnnou (nejlépe
realizovanou pomocí výètového typu enum) mù¾e být kód stavu, ve
kterém se nachází vyhodnocování. Podle aktuálnì naèteného znaku ze
souboru se stav mù¾e zmìnit a se znakem se provede pøíslu¹ná akce (u
na¹eho pøíkladu buï kopie na výstup, nebo &#8222;vypu¹tìní&#8220;).
<br>Pøíkazy switch lze vkládat do sebe (pøehlednost se dá zlep¹it
pou¾ítím ohranièujících blokù {} a nebo pomocí funkcí, které sní¾í
poèet øádkù). 
</p>
<p>&#8222;První/Vnìj¹í&#8220; pøíkaz switch pøepíná vìtev programu na
základì stavu. &#8222;Druhý/vnitøní&#8220; switch pøepíná na základì
události/vstupu. V ka¾dé vìtvi bychom mìli uva¾ovat zda dojde ke
zmìnì stavu a k jaké dojde èinnosti. V nìkterých stavech a situacích
nemusí dojít ani ke zmìnì stavu ani jiné èinnosti.</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><b>Doporuèený postup øe¹ení:</b></p>
<ul>
	<li><p>zalo¾ete nový konzolový projekt (jako základ zdrojových textù
	mù¾ete vzít soubory z minulého cvièení)</p>
	</li><li><p>v nastavení projektu (command arguments) napi¹te názvy
	vstupního a výstupního souboru. Mohlo by dojít ke kolizím pøi
	otevírání souborù. Jako projekt pou¾ijte prázdný bez <i>precompiled
	headers. </i><span style="font-style: normal"><b>Pro testování
	pou¾ívejte soubory, které nejsou souèástí projektu!!!</b></span>
	<span style="font-style: normal">Testovací soubor si mù¾ete vytvoøit
	i z textu na konci tohoto zadání.</span></p>
	</li><li><p>Soubor s main se bude jmenovat mainprj.c. Funkce budou v
	souboru funkce.c a pøíslu¹ném funkce.h. Soubory se otevøou v main,
	do funkcí se pøedá FILE *.</p>
	</li><li><p>Funkce main by mìla mít parametry argc a argv. Vytisknìte je
	(a zkontrolujte, ¾e mají oèekávané hodnoty).</p>
	</li><li><p>Pokuste se otevøít a zavøít vstupní a výstupní soubor.
	Otestujte, zda se operace povedly. (Otevøení proveïte v textovém
	modu. K otevøení pou¾ijte funkci fopen, k zavøení fclose. Operace se
	povedla, pokud fopen nevrátí NULL.).</p>
	</li><li><p>Zkuste soubor pouze pøekopírovat. (pou¾ijte fgetc a fputc.
	Obì funkce se chovají tak, ¾e se po provedení posunou v souboru o
	znak. To je &#8222; znak se po¹le do linky a zmizí.&#8220;) Pro test
	konce souboru pou¾ijte funkci feof.</p>
	</li><li><p><font color="#000000"><span style="background: transparent">Nakreslete
	si stavový diagram &#8211; stavy a pøechody mezi nimi (u pøechodù
	urèete kdy k nim dojde a jaká akce je provází)</span></font></p>
	</li><li><p>Naprogramujte stavový automat. 
	</p>
</li></ul>
<p><br><br>
</p>
<p><br><br>
</p>
<p><b>Pro pokroèilé</b></p>
<p>Doplòte program tak, aby øe¹il i:</p>
<p>- situaci, kdy se znak pro komentáø objeví v øetìzci. Napø.:
printf(&#8220;Komentáø se pí¹e takto: /* tady je komentáø */ nebo
takto: // tady je \&#8220;øádkový\&#8220; komentáø &#8220;); 
</p>
<p>- situaci, kdy by se ve výstupu nemìlo objevit více prázdných
øádkù za sebou (napø. kdy¾ vypou¹tíme 10 jednoøádkových komentáøù za
sebou). Po odstranìní komentáøù mohou v souboru zùstat rozsáhlej¹í
úseky prázdných øádkù. Na jejich odstranìní je mo¾né napsat jiný
program, s podobným principem. Program by dostal opìt názvy vstupního
a výstupního souboru. Jako dal¹í parametr by mohl být uveden poèet
ponechaných prázdných øádkù. Druhý program by mohl být pou¾it jako
zøetìzení pomocí roury (neboli pipe). (pøíklad volání kom_destr.exe
&lt;zdroje.cpp | radky_destr.exe &gt;zdroje_vyst.cpp)</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p>Na adrese desatomat.cz je mo¾né shlédnout vytvoøení stavového
automatu na základì zapsané gramatiky. Po kontrole stavového automatu
je automaticky vygenerován i zdrojový kód C++, který tento automat
realizuje. (klasický, bezkontextový, pøíklad pro Petyho).</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p>Testovací text:</p>
<p>&nbsp;</p>
<p style="margin-bottom: 0cm">&nbsp;</p>
<p style="margin-bottom: 0cm"><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">a</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">b</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">/</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">c</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;<br></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">d</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">a</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">/</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*</span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">pi</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;<br></span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>//
toto je komentar<br>// toto // je komentar<br>// toto je */
komentar<br>// toto je /* komentar<br>// toto je ** komentar *<br>/*
toto je komentar */<br>/* toto je komentar **/<br>/** toto je
komentar **/<br>/*** toto je komentar ***/<br>/* toto je * komentar
*/<br>/* toto je /* komentar */<br>/* toto je // komentar */<br>/*
toto je komentar *//* toto je komentar */<br>/* toto je komentar
*////* toto je komentar */<br>///* toto je komentar *//* toto je
komentar */<br>/* toto je /*** komentar */<br>/* toto je /** komentar
*/<br></i></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">a</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">g</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>//
toto je komentar<br></i></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">b</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">c</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>//
toto // je komentar<br></i></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">d</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*</span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">pi</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>//
toto je */ komentar<br></i></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">a</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>/*
toto je komentar */</i></span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">b</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;<br></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">h</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>/**
toto je komentar **/</i></span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*</span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">pi</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;<br></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">c</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">h</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>/*
toto je komentar */</i></span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">a</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;<br></span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">c</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">=</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">h</span></font></font></font><font color="#000000">
</font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US"><i>//*
toto je komentar */ a;<br></i></span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*</span></font></font></font><font color="#000000">
</font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">e</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">*=</span></font></font></font><font color="#000080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">d</span></font></font></font><font color="#808080"><font face="Courier New, monospace"><font size="3"><span lang="en-US">;</span></font></font></font></p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p>Pro pokroèilé [pøíklad z normy jazyka C: <font face="Times New Roman, serif"><font size="3">N1570
Committee Draft &#8212; April 12, 2011 </font></font><font face="Times New Roman, serif"><font size="3"><b>ISO/IEC
9899:201x</b></font></font>]</p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>"a//b"
// </b>four-character string literal</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>#include
"//e" // </b>undefined behavior</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>//
*/ // </b>comment, not syntax error</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>f
= g/**//h; // </b>equivalent to<b>f = g / h;</b></i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i>//\</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>i();
// </b>part of a two-line comment</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i>/\</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>/
j(); // </b>part of a two-line comment</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i>#define
glue(x,y) x##y</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>glue(/,/)
k(); // </b>syntax error, not comment</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>/*//*/
l(); // </b>equivalent to <b>l();</b></i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i>m
= n//**/o</i></font></font></font></p>
<p lang="en-US" style="margin-bottom: 0cm"><font color="#808080"><font face="Courier New, monospace"><font size="3"><i><b>+
p; // </b>equivalent to<b>m = n + p;</b></i></font></font></font></p>
<p><br><br>
</p>
<p><br><br>
</p>
<p>Poslední zmìna: 2015-09-29</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><br><br>
</p>
<p><br><br>
</p>

</body></html>